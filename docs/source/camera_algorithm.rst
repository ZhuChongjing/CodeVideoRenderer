动态相机算法
============

自适应缩放
----------------

为了确保长代码行也能完整显示，系统每渲染一个字符，都会判断是否需要拉远镜头。

.. math::
    
    D = \frac{X_\text{cam} - X_\text{origin}}{14.22}

如果计算出的目标系数 :math:`D` 大于当前的相机缩放，系统将触发 :func:`~.scale` 动画，将相机平滑拉远。

视觉律动
----------------

引入模拟呼吸感的微振荡算法。在输入一行代码时，相机不再是死板地水平移动，而是会产生极其微小的垂直浮动。浮动轨迹由以下公式决定：

.. math::
    
    \Delta y = A \cdot \sin(\pi \alpha) \cdot \sin(\omega \alpha)

.. list-table::
    :header-rows: 1
    :widths: 20 80

    * - 变量
      - 含义
    * - :math:`A`
      - 振幅。设定为相机当前画幅高度的 :math:`2.5\%`。
    * - :math:`\alpha`
      - 当前行的输入进度 :math:`(0 \to 1)`。
    * - :math:`\sin(\pi \alpha)`
      - 包络线。确保振荡在行首和行尾衰减为 :math:`0`，保证平滑过渡。
    * - :math:`\omega`
      - 振荡频率。基于当前行的字符总长度动态计算。
    
这种叠加了包络线的正弦振荡，使得长行代码的输入过程具有了类似“书写节奏”的自然起伏感。
