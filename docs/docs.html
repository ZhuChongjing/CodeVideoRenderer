<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档 - CodeVideoRenderer</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- 样式表引用 -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="furo.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <!-- 脚本引用 -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
</head>
<body> 
    
    <div class="bg-glow"></div>

    <!-- Header -->
    <header>
        <div class="container">
            <a href="index.html" style="text-decoration: none;">
                <h1 class="logo">
                    <svg class="site-icon" width="40" height="40" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="logo_gradient" x1="0" y1="100" x2="100" y2="0" gradientUnits="userSpaceOnUse">
                                <stop offset="0%" stop-color="#3b82f6" />
                                <stop offset="100%" stop-color="#60a5fa" />
                            </linearGradient>
                            <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                                <feGaussianBlur stdDeviation="3" result="blur" />
                                <feComposite in="SourceGraphic" in2="blur" operator="over" />
                            </filter>
                        </defs>
                        <rect x="15" y="15" width="70" height="70" rx="12" stroke="url(#logo_gradient)" stroke-width="6" fill="none"/>
                        <path d="M30 15V22 M50 15V22 M70 15V22" stroke="url(#logo_gradient)" stroke-width="4" stroke-linecap="round"/>
                        <path d="M30 78V85 M50 78V85 M70 78V85" stroke="url(#logo_gradient)" stroke-width="4" stroke-linecap="round"/>
                        <path d="M37 38 L57 50 L37 62" stroke="#f1f5f9" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" fill="none" style="filter: drop-shadow(0 0 5px rgba(255,255,255,0.5));"/>
                        <line x1="65" y1="32" x2="65" y2="68" stroke="#0DBC79" stroke-width="6" stroke-linecap="round" class="cursor-blink"/>
                    </svg>
                    <code>CodeVideoRenderer</code>
                </h1>
            </a>
            <nav>
                <a id="github-star-link" href="https://github.com/ZhuChongjing/CodeVideoRenderer" target="_blank" class="btn-github-star">
                    <span class="shine"></span>
                    <div class="content-left">
                        <i class="fab fa-github"></i>
                        <span style="margin-left: 4px;">Star on GitHub</span>
                    </div>
                    <div class="content-right">
                        <svg class="star-icon" fill="currentColor" viewBox="0 0 24 24">
                            <path clip-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z" fill-rule="evenodd" />
                        </svg>
                        <code id="star-count">-</code>
                        <script>
                            window.onload = function() {
                                fetch('https://api.github.com/repos/ZhuChongjing/CodeVideoRenderer')
                                    .then(response => response.json())
                                    .then(data => {
                                        document.getElementById('star-count').textContent = data.stargazers_count;
                                    });
                            }
                        </script>
                    </div>
                </a>
                <a class="nav-button" id="github-link" href="https://github.com/ZhuChongjing/CodeVideoRenderer" target="_blank" title="GitHub">
                    <i class="fab fa-github"></i>
                </a>
                <a class="nav-button" href="mailto:zhuchongjing_pypi@163.com" target="_blank" title="Email">
                    <i class="fas fa-envelope"></i>
                </a>
                <a class="nav-button" href="index.html" title="返回首页">
                    <i class="fas fa-home"></i>
                </a>
            </nav>
        </div>
    </header>

    <div class="container docs-layout">
        <!-- 左侧侧边栏导航 -->
        <aside class="docs-sidebar">
            <nav class="sidebar-nav">
                <div class="nav-group">
                    <span class="nav-title">开始</span>
                    <a href="#intro" class="nav-link active">简介</a>
                    <a href="#install" class="nav-link">安装</a>
                    <a href="#quickstart" class="nav-link">快速上手</a>
                </div>
                <div class="nav-group">
                    <span class="nav-title">核心类</span>
                    <a href="#CameraFollowCursorCV" class="nav-link"><code>CameraFollowCursorCV</code></a>
                    <a href="#init-params" class="nav-link">初始化参数</a>
                    <a href="#render-method" class="nav-link">渲染方法</a>
                </div>
                <div class="nav-group">
                    <span class="nav-title">进阶</span>
                    <a href="#input-logic" class="nav-link">输入源处理</a>
                    <a href="#algo" class="nav-link">相机算法</a>
                </div>
            </nav>
        </aside>

        <!-- 右侧主内容 -->
        <main class="docs-content">
            
            <!-- 简介 -->
            <section id="intro">
                <h1>简介</h1>
                <p><code class="class">CameraFollowCursorCV</code> 是本库的核心类，专门设计用于模拟代码输入的动画过程。它通过逐行、逐字符的动画效果，配合平滑的摄像机跟随，创造出具有专业水准的代码演示视频。</p>
                <div class="admonition note">
                    <p class="admonition-title"><code>v1.1.0</code> 新特性</p>
                    <p class="admonition-text">引入了基于 <code class="class">numpy</code> 的相机律动算法，在打字过程中产生自然的微振荡，大幅提升观感流畅度。</p>
                </div>
            </section>

            <!-- 安装 -->
            <section id="install">
                <h2>安装</h2>
                <div class="admonition tip">
                    <p class="admonition-title">安装要求</p>
                    <p class="admonition-text"><strong><code>Python</code> 版本要求：</strong><code style="color: white;">>=3.9</code></p>
                    <p class="admonition-text"><strong><code>Python</code> 包依赖：</strong><code style="color: white;"><span class="class">manim</span>>=0.17.0, <span class="class">rich</span>>=13.0.0</code></p>
                    <p class="admonition-text"><strong>第三方软件依赖：</strong><a href="https://ffmpeg.org/" target="_blank" title="FFmpeg"><code style="color: white;">FFmpeg</code></a></p>
                </div>
                <p>您可以通过以下命令安装：</p>
                <div class="code-block-wrapper">
                    <pre><code class="bash">pip install CodeVideoRenderer</code></pre>
                    <button class="copy-btn" onclick="navigator.clipboard.writeText('pip install CodeVideoRenderer')"><i class="far fa-copy"></i></button>
                </div>
            </section>

            <!-- 快速开始 -->
            <section id="quickstart">
                <h2>快速上手</h2>
                <p>以下代码展示了如何生成一个最简单的视频：</p>
                
                <div class="code-block-wrapper">
                    <pre><code class="python">from CodeVideoRenderer import CameraFollowCursorCV
video = CameraFollowCursorCV(
    video_name="Demo",                    # 文件名
    code_string="print('Hello World!')",  # 代码
    language="python"                     # 语言
)
video.render()</code></pre>
                    <button class="copy-btn" onclick="navigator.clipboard.writeText(this.previousElementSibling.innerText)"><i class="far fa-copy"></i></button>
                </div>
                <p>渲染结束后，您将在终端看到 <code class="string">Demo.mp4</code> 文件的保存路径。</p>
            </section>

            <!-- 类定义 -->
            <section id="CameraFollowCursorCV">
                <h2><code class="class">CameraFollowCursorCV</code> 类</h2>
                <div class="versionchanged">
                    <p><span class="versionmodified">在<code>1.0.7.post2</code>版本中</span>将原名<code class="class">CodeVideo</code>改为<code class="class">CameraFollowCursorCV</code></p>
                </div>
                <div class="versionremoved">
                    <p><span class="versionmodified">在<code>1.0.9</code>版本中</span>删除了参数<code class="variable">camera_floating_max_value</code>、<code class="variable">camera_move_interval</code>、<code class="variable">camera_move_duration</code></p>
                </div>
                <p>该类继承并封装了 $\mathbb{M}\text{anim}$ 的场景逻辑，自动处理光标移动、换行、缩进以及摄像机的运动轨迹。</p>
                <div class="admonition note">
                    <p class="admonition-title">参数类型检查</p>
                    <p class="admonition-text">该类会使用<code class="function">type_checker</code>来检查您传入的参数类型是否正确。</p>
                </div>
                <div class="code-block-wrapper">
                    <pre><code class="python">class CameraFollowCursorCV(
    video_name: str = "CameraFollowCursorCV",
    code_string: str = None,
    code_file: str = None,
    language: str = None,
    line_spacing: float | int = DEFAULT_LINE_SPACING,
    interval_range: tuple[float | int, float | int] = (DEFAULT_TYPE_INTERVAL, DEFAULT_TYPE_INTERVAL),
    camera_scale: float | int = 0.5
)</code></pre>
                </div>
            </section>

            <!-- 初始化参数 -->
            <section id="init-params">
                <h3>初始化参数 <code class="function">__init__</code></h3>
                <p>在创建实例时，您可以配置以下参数来控制视频的生成细节：</p>

                <table class="docs-table">
                    <thead>
                        <tr>
                            <th style="width: 20%">参数名</th>
                            <th style="width: 20%">类型</th>
                            <th>说明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code class="variable">video_name</code></td>
                            <td><code class="class">str</code></td>
                            <td>输出视频的文件名（无需后缀）。</td>
                        </tr>
                        <tr>
                            <td><code class="variable">code_string</code></td>
                            <td><code class="class">str</code></td>
                            <td>直接传入的代码字符串。</td>
                        </tr>
                        <tr>
                            <td><code class="variable">code_file</code></td>
                            <td><code class="class">str</code></td>
                            <td>代码文件的路径。支持读取本地文件内容。</td>
                        </tr>
                        <tr>
                            <td><code class="variable">language</code></td>
                            <td><code class="class">str</code></td>
                            <td>用于语法高亮的语言名称（如 <code class="string">"python"</code>、<code class="string">"c++"</code>等）。</td>
                        </tr>
                        <tr>
                            <td><code class="variable">line_spacing</code></td>
                            <td><code><span class="class">float</span> | <span class="class">int</span></code></td>
                            <td>行间距。默认值基于配置常量，必须大于 <code class="number">0</code>。</td>
                        </tr>
                        <tr>
                            <td><code class="variable">interval_range</code></td>
                            <td><code class="class">tuple</code></td>
                            <td>打字间隔范围 <code>(<span class="variable">min</span>, <span class="variable">max</span>)</code>。单位为秒。</td>
                        </tr>
                        <tr>
                            <td><code class="variable">camera_scale</code></td>
                            <td><code><span class="class">float</span> | <span class="class">int</span></code></td>
                            <td>相机的初始缩放比例。默认为 <code class="number">0.5</code>。</td>
                        </tr>
                    </tbody>
                </table>
                <div class="admonition warning">
                    <p class="admonition-title">注意</p>
                    <p class="admonition-text"><code class="variable">code_string</code> 和 <code class="variable">code_file</code> 必须且只能提供其中一个。</p>
                    <p class="admonition-text">代码内容不能为空，且只能包含<code class="constant">AVAILABLE_CHARACTERS</code>。</p>
                    <p class="admonition-text">所有时间相关参数必须大于或等于$\small\cfrac{1}{当前帧率}$（取七位小数）。</p>
            </section>

            <!-- 渲染方法 -->
            <section id="render-method">
                <h3>渲染方法 <code class="function">render</code><code>()</code></h3>
                <div class="code-block-wrapper">
                    <pre><code class="python">def render(self, output: bool = True) -> None:</code></pre>
                </div>
                <p>启动 $\mathbb{M}\text{anim}$ 渲染流程。渲染前会在控制台通过 <code class="class">rich</code><code>.</code><code class="class">panel</code> 打印任务摘要，并显示包含速度和剩余时间的详细进度条。</p>
                <table class="docs-table">
                    <thead>
                        <tr>
                            <th style="width: 20%">参数名</th>
                            <th style="width: 20%">类型</th>
                            <th>说明</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code class="variable">output</code></td>
                            <td><code class="class">bool</code></td>
                            <td>是否输出视频文件。默认值为 <code class="literal">True</code>。</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- 输入处理逻辑 -->
            <section id="input-logic">
                <h2>输入源处理逻辑</h2>
                <p>库内部会对输入的代码进行严格的预处理，以保证渲染稳定性：</p>
                <ol>
                    <li><strong>Tab 转换</strong>: 所有的制表符 <code class="string">\t</code> 会被自动展开为空格（默认宽度 <code class="number">4</code>）。</li>
                    <li><strong>字符校验</strong>: 自动检测代码中是否包含 $\mathbb{M}\text{anim}$ 无法渲染的非法字符。</li>
                    <li><strong>空行处理</strong>: 代码首尾的空行会被自动剔除，但保留段落间的空行以维持格式。</li>
                </ol>
            </section>

            <!-- 算法 -->
            <section id="algo">
                <h2>动态相机算法</h2>
                
                <h3>自适应缩放</h3>
                <p>为了确保长代码行也能完整显示，系统每渲染一个字符，都会判断是否需要拉远镜头。<code>v1.1.0</code> 优化了视觉系数。</p>
                
                <div class="math-block">
                    $$ D = \frac{X_\text{cam} - X_\text{origin}}{14.22} $$
                </div>
                
                <p>如果计算出的目标系数 $D$ 大于当前的相机缩放，系统将触发 <code class="function">scale</code> 动画，将相机平滑拉远。</p>

                <h3>视觉律动</h3>
                <p><code>v1.1.0</code> 引入了模拟呼吸感的微振荡算法。在输入一行代码时，相机不再是死板地水平移动，而是会产生极其微小的垂直浮动。浮动轨迹由以下公式决定：</p>

                <div class="math-block">
                    $$ \Delta y = A \cdot \sin(\pi \alpha) \cdot \sin(\omega \alpha) $$
                </div>

                <table class="docs-table">
                    <thead>
                        <tr>
                            <th>变量</th>
                            <th>含义</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>$A$</td>
                            <td>振幅。设定为相机当前画幅高度的$2.5\%$。</td>
                        </tr>
                        <tr>
                            <td>$\alpha$</td>
                            <td>当前行的输入进度$(0 \to 1)$。</td>
                        </tr>
                        <tr>
                            <td>$\sin(\pi \alpha)$</td>
                            <td><strong>包络线</strong>。确保振荡在行首和行尾衰减为$0$，保证平滑过渡。</td>
                        </tr>
                        <tr>
                            <td>$\omega$</td>
                            <td>振荡频率。基于当前行的字符总长度动态计算。</td>
                        </tr>
                    </tbody>
                </table>
                <p>这种叠加了包络线的正弦振荡，使得长行代码的输入过程具有了类似“书写节奏”的自然起伏感。</p>
            </section>

        </main>
    </div>
    
    <footer>
        <div class="container">
            <p class="copyright">Copyright © 2025 ZhuChongjing. All rights reserved. Released under MIT License.</p>
            <p style="display: inline-block;">Made with</p>
            <a href="https://gemini.google.com/" style="display: inline-block;">
                <img src="./images/gemini.png" height="15" style="display: inline-block; vertical-align: middle;" alt="Gemini">
            </a>
            <a href="https://uiverse.io" style="display: inline-block;">
                <img src="./images/uiverse.webp" height="12" style="display: inline-block; vertical-align: middle;" alt="UIverse">
            </a>
            <p style="display: inline-block; margin-left: 3px;">and</p>
            <a href="https://pradyunsg.me" style="display: inline-block;">@pradyunsg</a>'s
            <a href="https://github.com/pradyunsg/furo" style="display: inline-block;">Furo</a>
        </div>
    </footer>

    <!-- 脚本初始化 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="script.js"></script>
</body>

</html>


